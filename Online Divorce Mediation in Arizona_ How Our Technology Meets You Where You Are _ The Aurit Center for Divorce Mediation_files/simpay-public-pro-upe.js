!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=58)}([function(e,t,r){var n=r(13);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";function n(e,t){var r=t.settings,n=r.taxRates,i=r.taxStatus,a=t.state.price,o=a.unit_amount,c=a.currency,u=a.can_recur,s=a.recurring;return e.update({currency:c,taxRates:n,taxStatus:i}),e.addLineItem({id:"setup-fee",title:"Initial Setup Fee",amount:0,quantity:1,subscription:!1}),e.addLineItem({id:"plan-setup-fee",title:"Plan Setup Fee",amount:0,quantity:1,subscription:!1}),e.addLineItem({id:"base",price:a,title:s&&!1===u?"Subscription":"One Time",amount:o,quantity:1,subscription:!(!s||!1!==u)&&{isTrial:!!s.trial_period_days,interval:s.interval,intervalCount:s.interval_count}}),e}function i(e){return Math.abs(accounting.unformat(e,this.i18n.decimalSeparator))}function a(e,t,r,n){var i=t||!1,a=r||this.i18n.currencySymbol,o=n||!1,c="%s%v";if(i)switch(this.i18n.currencyPosition){case"left_space":c="%s %v";break;case"right":c="%v%s";break;case"right_space":c="%v %s"}var u={symbol:i?a:"",decimal:this.i18n.decimalSeparator,thousand:this.i18n.thousandSeparator,precision:o?0:this.i18n.decimalPlaces,format:c};return accounting.formatMoney(e,u)}function o(e){return accounting.toFixed(e/100,2)}function c(e){return Number(accounting.toFixed(100*e,0))}r.d(t,"l",(function(){return n})),r.d(t,"m",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"h",(function(){return m})),r.d(t,"f",(function(){return d})),r.d(t,"j",(function(){return y})),r.d(t,"i",(function(){return f})),r.d(t,"g",(function(){return v})),r.d(t,"a",(function(){return _})),r.d(t,"k",(function(){return x})),r.d(t,"d",(function(){return j}));var u=r(0),s=r.n(u);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e){var t,r,n=p({loader:"auto"},e);if(e.appearance)return n;if(document.createElement("style").id="simpay-stripe-element-styles",t=document.querySelector('.simpay-checkout-form input[type="email"]'),r=document.querySelector(".simpay-checkout-form label"),t||(t=document.querySelector('body [role="main"] input:not([type="hidden"])'),r=document.querySelector('body [role="main"] label')),!t||!r)return n;var i=window.getComputedStyle(t),a=window.getComputedStyle(r),o={variables:{fontSizeBase:a.getPropertyValue("font-size"),fontFamily:a.getPropertyValue("font-family"),borderRadius:i.getPropertyValue("border-radius")},rules:{".Tab":{boxShadow:i.getPropertyValue("box-shadow"),border:i.getPropertyValue("border"),borderRadius:i.getPropertyValue("border-radius"),background:i.getPropertyValue("background")},".Input":{color:i.getPropertyValue("color"),fontSize:i.getPropertyValue("font-size"),fontWeight:i.getPropertyValue("font-weight"),lineHeight:i.getPropertyValue("line-height"),padding:i.getPropertyValue("padding"),boxShadow:i.getPropertyValue("box-shadow"),border:i.getPropertyValue("border"),borderRadius:i.getPropertyValue("border-radius"),background:i.getPropertyValue("background")}}},c=document.activeElement;t.focus();var u=window.getComputedStyle(t);return c.focus(),p(p({},n),{},{appearance:{theme:"stripe",variables:p({},o.variables),rules:p(p({},o.rules),{},{".Tab:focus":{boxShadow:u.getPropertyValue("box-shadow"),border:u.getPropertyValue("border"),borderRadius:u.getPropertyValue("border-radius"),background:u.getPropertyValue("background"),outline:u.getPropertyValue("outline"),outlineOffset:u.getPropertyValue("outline-offset")},".Tab--selected":{boxShadow:u.getPropertyValue("box-shadow"),border:u.getPropertyValue("border"),borderRadius:u.getPropertyValue("border-radius"),background:u.getPropertyValue("background"),outline:u.getPropertyValue("outline"),outlineOffset:u.getPropertyValue("outline-offset")},".Input:focus":{color:u.getPropertyValue("color"),fontSize:u.getPropertyValue("font-size"),fontWeight:u.getPropertyValue("font-weight"),lineHeight:u.getPropertyValue("line-height"),padding:u.getPropertyValue("padding"),boxShadow:u.getPropertyValue("box-shadow"),border:u.getPropertyValue("border"),borderRadius:u.getPropertyValue("border-radius"),background:u.getPropertyValue("background"),outline:u.getPropertyValue("outline"),outlineOffset:u.getPropertyValue("outline-offset")}})}})}function d(e){return e.settings.paymentMethods[0]}function y(){var e=this.settings,t=this.cart,r=e.allowMultipleLineItem,n=e.paymentMethods,i=t.getCurrency(),a=t.isRecurring();"yes"===r&&(a=!0);var o=n.filter((function(e){return e.currencies.includes(i)})).map((function(e){return e.id})),c=n.filter((function(e){return!0===e.recurring})).map((function(e){return e.id})),u=n.filter((function(e){var t=e.id;return!!o.includes(t)&&(!a||c.includes(t))})).map((function(e){return e.id}));return this.querySelector(".simpay-link-authentication-container")&&u.push("link"),t.getTotalDueToday()<1e4&&(u=u.filter((function(e){return"affirm"!==e}))),u}function f(){var e,t={},r=this.settings.paymentMethods.find((function(e){return"us_bank_account"===e.id}));return r&&(t.us_bank_account={verification_method:null!==(e=r.config)&&void 0!==e&&e.verification_method?"automatic":"instant"}),t}function v(e){return Object.values(e.settings.prices).filter((function(e){return!0===e.default}))[0]}var g=r(3),h=r.n(g);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e){var t=e.cart,r=e.cart.taxStatus,n=e.error,i=e.disable,a=e.enable,o=e.formId,c=e.settings,u=e.setState,l=e.state,p=c.addressType,m=l.displayType,d=l.coupon,y=l.customAmount,f=l.isCoveringFees,v=l.isOptionallyRecurring;if("automatic"!==r||"stripe_checkout"===m)return Promise.resolve(null);var g=l["".concat(p,"Address")]||!1;if(!g||!g.complete)return Promise.resolve(null);n(""),i();var b=t.getLineItem("base");return window.wp.apiFetch({url:window.spGeneral.strings.wpJsonUrl+"wpsp/__internal__/payment/calculate-tax",method:"POST",data:s()(s()(s()(s()({form_id:o,price_id:b.price.id,quantity:b.quantity,custom_amount:y,is_optionally_recurring:v,is_covering_fees:f,coupon_code:!1!==d?d:null},"".concat(p,"_address"),g.address||null),"form_values",h()(e,{hash:!0})),"prices",S(e)),"price_ids",t.getPriceIds())}).then((function(e){var r=e.total_details,n=e.upcoming_invoice,i=e.tax,a=e.id;u({taxCalculationId:a}),t.update({automaticTax:O(O({},r),{},{upcomingInvoice:n}),taxBehavior:i.behavior})})).catch((function(e){n(e)})).finally(a)}function S(e){var t=e.cart,r=[];return t.getLineItems().forEach((function(e){e.checked&&r.push({price_id:e.price.id,quantity:e.quantity,is_optionally_recurring:e.isOptionallyRecurring,custom_amount:e.amount,price_data:e.price})})),r}function x(){if(window.simpayGoogleRecaptcha){var e=window.simpayGoogleRecaptcha.siteKey;return new Promise((function(t){grecaptcha.execute(e,{action:"simpay_payment"}).then((function(e){return t(e)})).catch((function(){return t(null)}))}))}var t=this.querySelector('[name="h-captcha-response"]');if(t)return Promise.resolve(t.value);var r=this.querySelector('[name="cf-turnstile-response"]');return r?Promise.resolve(r.value):Promise.resolve(null)}function j(e,t){var r,n=this;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];clearTimeout(r),r=setTimeout((function(){e.apply(n,a)}),t)}}},function(e,t){var r=/^(?:submit|button|image|reset|file)$/i,n=/^(?:input|select|textarea|keygen)/i,i=/(\[[^\[\]]*\])/g;function a(e,t,r){if(t.match(i))!function e(t,r,n){if(0===r.length)return n;var i=r.shift(),a=i.match(/^\[(.+?)\]$/);if("[]"===i)return t=t||[],Array.isArray(t)?t.push(e(null,r,n)):(t._values=t._values||[],t._values.push(e(null,r,n))),t;if(a){var o=a[1],c=+o;isNaN(c)?(t=t||{})[o]=e(t[o],r,n):(t=t||[])[c]=e(t[c],r,n)}else t[i]=e(t[i],r,n);return t}(e,function(e){var t=[],r=new RegExp(i),n=/^([^\[\]]*)/.exec(e);for(n[1]&&t.push(n[1]);null!==(n=r.exec(e));)t.push(n[1]);return t}(t),r);else{var n=e[t];n?(Array.isArray(n)||(e[t]=[n]),e[t].push(r)):e[t]=r}return e}function o(e,t,r){return r=r.replace(/(\r)?\n/g,"\r\n"),r=(r=encodeURIComponent(r)).replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+r}e.exports=function(e,t){"object"!=typeof t?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var i=t.hash?{}:"",c=t.serializer||(t.hash?a:o),u=e&&e.elements?e.elements:[],s=Object.create(null),l=0;l<u.length;++l){var p=u[l];if((t.disabled||!p.disabled)&&p.name&&n.test(p.nodeName)&&!r.test(p.type)){var m=p.name,d=p.value;if("checkbox"!==p.type&&"radio"!==p.type||p.checked||(d=void 0),t.empty){if("checkbox"!==p.type||p.checked||(d=""),"radio"===p.type&&(s[p.name]||p.checked?p.checked&&(s[p.name]=!0):s[p.name]=!1),null==d&&"radio"==p.type)continue}else if(!d)continue;if("select-multiple"!==p.type)i=c(i,m,d);else{d=[];for(var y=p.options,f=!1,v=0;v<y.length;++v){var g=y[v],h=t.empty&&!g.value,b=g.value||h;g.selected&&b&&(f=!0,i=t.hash&&"[]"!==m.slice(m.length-2)?c(i,m+"[]",g.value):c(i,m,g.value))}!f&&t.empty&&(i=c(i,m,""))}}}if(t.empty)for(var m in s)s[m]||(i=c(i,m,""));return i}},,function(e,t,r){var n=r(29),i=r(30),a=r(31),o=r(32);e.exports=function(e){return n(e)||i(e)||a(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},,function(e,t,r){"use strict";let n;function i(e){if("string"!=typeof e||-1===e.indexOf("&"))return e;void 0===n&&(n=document.implementation&&document.implementation.createHTMLDocument?document.implementation.createHTMLDocument("").createElement("textarea"):document.createElement("textarea")),n.innerHTML=e;const t=n.textContent;return n.innerHTML="",t}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return g}));var n=function(e){return"string"!=typeof e||""===e?(console.error("The namespace must be a non-empty string."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)||(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)},i=function(e){return"string"!=typeof e||""===e?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):!!/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)||(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)},a=function(e){return function(t,r,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(i(t)&&n(r))if("function"==typeof a)if("number"==typeof o){var c={callback:a,priority:o,namespace:r};if(e[t]){var u,s=e[t].handlers;for(u=s.length;u>0&&!(o>=s[u-1].priority);u--);u===s.length?s[u]=c:s.splice(u,0,c),(e.__current||[]).forEach((function(e){e.name===t&&e.currentIndex>=u&&e.currentIndex++}))}else e[t]={handlers:[c],runs:0};"hookAdded"!==t&&y("hookAdded",t,r,a,o)}else console.error("If specified, the hook priority must be a number.");else console.error("The hook callback must be a function.")}},o=function(e,t){return function(r,a){if(i(r)&&(t||n(a))){if(!e[r])return 0;var o=0;if(t)o=e[r].handlers.length,e[r]={runs:e[r].runs,handlers:[]};else for(var c=e[r].handlers,u=function(t){c[t].namespace===a&&(c.splice(t,1),o++,(e.__current||[]).forEach((function(e){e.name===r&&e.currentIndex>=t&&e.currentIndex--})))},s=c.length-1;s>=0;s--)u(s);return"hookRemoved"!==r&&y("hookRemoved",r,a),o}}},c=function(e){return function(t,r){return void 0!==r?t in e&&e[t].handlers.some((function(e){return e.namespace===r})):t in e}},u=function(e,t){return function(r){e[r]||(e[r]={handlers:[],runs:0}),e[r].runs++;for(var n=e[r].handlers,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];if(!n||!n.length)return t?a[0]:void 0;var c={name:r,currentIndex:0};for(e.__current.push(c);c.currentIndex<n.length;){var u=n[c.currentIndex],s=u.callback.apply(null,a);t&&(a[0]=s),c.currentIndex++}return e.__current.pop(),t?a[0]:void 0}},s=function(e){return function(){return e.__current&&e.__current.length?e.__current[e.__current.length-1].name:null}},l=function(e){return function(t){return void 0===t?void 0!==e.__current[0]:!!e.__current[0]&&t===e.__current[0].name}},p=function(e){return function(t){if(i(t))return e[t]&&e[t].runs?e[t].runs:0}},m=function(){var e=Object.create(null),t=Object.create(null);return e.__current=[],t.__current=[],{addAction:a(e),addFilter:a(t),removeAction:o(e),removeFilter:o(t),hasAction:c(e),hasFilter:c(t),removeAllActions:o(e,!0),removeAllFilters:o(t,!0),doAction:u(e),applyFilters:u(t,!0),currentAction:s(e),currentFilter:s(t),doingAction:l(e),doingFilter:l(t),didAction:p(e),didFilter:p(t),actions:e,filters:t}},d=m(),y=(d.addAction,d.addFilter,d.removeAction,d.removeFilter,d.hasAction,d.hasFilter,d.removeAllActions,d.removeAllFilters,d.doAction),f=(d.applyFilters,d.currentAction,d.currentFilter,d.doingAction,d.doingFilter,d.didAction,d.didFilter,d.actions,d.filters,m()),v=f.addAction,g=(f.addFilter,f.doAction);f.applyFilters},function(e,t){e.exports=jQuery},,,function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return l}));var n=r(0),i=r.n(n),a=r(14);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t){var r=e.querySelector(".simpay-payment-method-error");if(r){var n=e.i18n.emptyPaymentMethodError;r.innerText=t||n,r.style.display="block",wp.a11y.speak(n,"assertive")}}function s(e){var t=e.querySelector(".simpay-payment-method-error");t&&(t.innerText="",t.style.display="none")}function l(e){e.classList.remove("simpay-checkout-form--loading"),e.classList.add("simpay-checkout-form--requires_payment_method"),e.querySelectorAll("input, select, textarea").forEach((function(e){e.disabled=!0,e.tabIndex=-1})),Object(a.b)(e)}function p(e,t){var r=t.paymentForm,n=r.cart,i=r.getPaymentMethodTypes;r.stripeElements.update({currency:n.getCurrency(),captureMethod:"automatic",amount:0!==n.getTotalDueToday()?n.getTotalDueToday():n.getLineItem("base").price.unit_amount,setupFutureUsage:n.isRecurring()?"off_session":null,mode:n.isRecurring()?"subscription":"payment",paymentMethodTypes:i(r)})}t.a=function(e){var t=e.paymentForm,r=t.type,n=t.enable;"off-site"!==r?(function(e){var t=e.paymentForm,r=t.stripe.paymentElement,n=t.getPaymentMethodTypes,i=t.enable,a=t.i18n,o=t.setState,m=t.settings,d=t.stripeElements,y=m.hasPhoneField,f=m.hasNameField,v=m.hasWallets,g=m.paymentMethods,h=d.create("payment",c({wallets:{applePay:v?"auto":"never",googlePay:v?"auto":"never"},business:{name:a.siteTitle||""},layout:{type:"tabs",defaultCollapsed:!1},defaultValues:{billingDetails:{email:t.state.email,name:t.state.name,phone:t.state.phone}},fields:{billingDetails:{email:"never",name:f?"never":"auto",phone:y?"never":"auto",address:"auto"}},paymentMethodOrder:n(t)},r));h.mount(t.querySelector(".simpay-upe-wrap")),o({paymentElement:h}),h.on("ready",i),h.on("change",(function(r){var n=r.complete,i=r.value,a="apple_pay"===i.type;switch(o({isApplePay:a}),i.type){case"link":case"apple_pay":case"google_pay":i.type="card"}var m=g.filter((function(e){return e.id===i.type}))[0],d=t.state.paymentMethod!==m;(d||n)&&s(t),o({paymentElement:c(c({},h),{},{complete:n}),paymentMethod:m}),d&&(t.state.clientSecret?function(e){var t=e.paymentForm,r=t.disable,n=t.error,i=t.formId,a=t.settings,o=t.setState,c=t.state,u=t.stripeElements,p=a.hasFeeRecovery,m=c.clientSecret,d=c.customAmount,y=c.customerId,f=c.isCoveringFees,v=c.objectId,g=c.paymentMethod,h=c.price;if(!m)return Promise.resolve(null);if(!p)return Promise.resolve(null);r(),n(""),s(t);var b={customer_id:y,form_id:i,object_id:v,price_id:h.id,custom_amount:d,payment_method_type:g.id,is_covering_fees:f};return window.wp.apiFetch({url:window.spGeneral.strings.wpJsonUrl+"wpsp/__internal__/payment/update",method:"POST",data:b}).then((function(e){o({clientSecret:e.client_secret,objectId:e.object_id,objectPaymentMethodType:g.id}),e.changed&&u.update({clientSecret:e.client_secret})})).catch((function(e){n(e),l(t)}))}(e).catch((function(e){u(e)})).finally((function(){l(t),e.trigger("totalChanged",[e])})):e.trigger("totalChanged",[e])),e.on("totalChanged",p)}))}(e),n()):n()}},function(e,t,r){var n=r(1).default,i=r(21);e.exports=function(e){var t=i(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(8);function i(e){var t=e.cart,r=e.convertToDollars,n=e.formatCurrency,i=e.i18n,a=i.checkoutButtonText,o=i.checkoutButtonTrialText,c=e.querySelector(".simpay-checkout-btn");if(c){var u;if(c.disabled=!1,c.classList.remove("simpay-disabled"),t.hasFreeTrial())u=o;else{var s=n(t.isZeroDecimal()?t.getTotalDueToday():r(t.getTotalDueToday()),!0,t.getCurrencySymbol(),t.isZeroDecimal()),l='<em class="simpay-total-amount-value">'.concat(s,"</em>");u=a.replace("{{amount}}",l)}c.querySelector("span").innerHTML=u}}function a(e){var t=e.i18n.checkoutButtonLoadingText,r=e.querySelector(".simpay-checkout-btn");r&&(r.disabled=!0,r.classList.add("simpay-disabled"),r.querySelector("span").innerText=t)}t.a=function(e){Object(n.a)("simpayEnablePaymentForm","wpsp/paymentForm",i),Object(n.a)("simpayDisablePaymentForm","wpsp/paymentForm",a)}},,function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return s}));var n=r(0),i=r.n(n);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.state&&!0===e.state.hasMaxAmountError)return!1;var r=e.cart,n=e.unformatCurrency,i=e.convertToCents;if(t){var a=e.querySelectorAll(".simpay-custom-amount-input"),o=!0;return a.forEach((function(e){var t=e.closest(".simpay-price-selection-label").querySelector('[name="simpay_price"]');if(t&&t.checked){var r=JSON.parse(t.dataset.price),a=r.is_zero_decimal?n(e.value):i(n(e.value));if(a<parseInt(r.unit_amount_min)||a>parseInt(r.unit_amount_max))return o=!1,!1}})),o}var c=r.getLineItem("base"),u=c.price;if(!u.id.startsWith("simpay_"))return!0;var s=e.querySelector('input[name="simpay_custom_price_amount"]');return!s||""!==s.value}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.querySelector(".simpay-custom-amount-error");if(r){var n=e.cart,i=e.convertToDollars,a=e.formatCurrency,o=e.i18n,c=e.state,u=c.price.unit_amount_min,s=o.emptyCustomAmountError.replace("%s",a(n.isZeroDecimal()?u:i(u),!0,n.getCurrencySymbol(),n.isZeroDecimal()));r.innerText=t||s,r.style.display="block",wp.a11y.speak(s,"assertive"),e.querySelector(".simpay-custom-amount-container").classList.add("is-error"),e.querySelector('input[name="simpay_custom_price_amount"]').focus()}}function s(e){var t=e.querySelector(".simpay-custom-amount-error");t&&(t.innerText="",t.style.display="none")}t.a=function(e){e.on("simpayMultiPlanChanged",(function(){s(e.paymentForm),function(e){var t=e.paymentForm,r=t.cart,n=t.convertToDollars,i=t.formatCurrency,a=r.getLineItem("base").price,c=a.id,u=a.unit_amount,s=a.currency_symbol,l=t.querySelector(".simpay-custom-amount-container");if(l){var p=l.querySelector(".simpay-currency-symbol"),m=t.querySelector('input[name="simpay_custom_price_amount"]');l.style.display=c.startsWith("simpay_")?"block":"none",p.innerHTML=s;var d=r.getLineItem("base");d.update(o(o({},d),{},{amount:parseInt(u)}));var y=m.dataset,f=y.placeholder,v=y.prefillDefault,g=r.isZeroDecimal()?u:n(u),h=c.startsWith("simpay_")?i(g,!1,r.getCurrencySymbol(),r.isZeroDecimal()):"";m.value=""!==v?h:"","{{amount}}"===f&&(m.placeholder=h)}}(e)})),function(e){var t=e.paymentForm.querySelector('input[name="simpay_custom_price_amount"]');t&&t.addEventListener("blur",(function(t){!function(e,t){if(""!==e){var r=t.paymentForm,n=r.cart,i=r.convertToCents,a=r.convertToDollars,c=r.formatCurrency,l=r.i18n,p=r.unformatCurrency,m=n.getLineItem("base"),d=m.price,y=d.unit_amount_min,f=d.unit_amount_max,v=n.isZeroDecimal()?p(e):i(p(e)),g=r.querySelector('input[name="simpay_custom_price_amount"]'),h=c(n.isZeroDecimal()?y:a(y),!0,n.getCurrencySymbol(),n.isZeroDecimal()),b=c(n.isZeroDecimal()?f:a(f),!0,n.getCurrencySymbol(),n.isZeroDecimal());v<parseInt(y)?(r.setState({customAmount:y}),g.parentNode.classList.add("is-error"),g.value="",g.focus(),u(r,l.minCustomAmountError.replace("%s",h))):v>parseInt(f)?(r.setState({customAmount:f,hasMaxAmountError:!0}),g.parentNode.classList.add("is-error"),g.value="",g.focus(),u(r,l.maxCustomAmountError.replace("%s",b))):(r.setState({customAmount:v,hasMaxAmountError:!1}),s(r),m.update(o(o({},m),{},{amount:v})),g.parentNode.classList.remove("is-error"),g.value=c(n.isZeroDecimal()?v:a(v),!1,n.getCurrencySymbol(),n.isZeroDecimal())),t.trigger("totalChanged",[t])}}(t.target.value,e)}))}(e)}},function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l}));var n=r(0),i=r.n(n),a=r(2);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.querySelector(".simpay-address-error");if(r){var n=e.i18n,i=n.emptyAddressError;r.style.display="block",r.innerText=t||i,wp.a11y.speak(i,"assertive")}}function s(e){var t=e.querySelector(".simpay-address-error");t&&(t.style.display="none",t.innerText="")}function l(e){var t=e.settings,r=e.state,n=t.addressType,i=r["".concat(n,"AddressElement")],a=r.paymentMethod;if(!i||"billing"===n&&"klarna"===a.id)return!0;var o=!r["".concat(n,"Address")]||r["".concat(n,"Address")].complete;return o||i.focus(),o}t.a=function(e){var t,r,n,o,u,l,p=e.paymentForm,m=p.settings,d=p.setState,y=p.state,f=p.stripeElements,v=m.addressType,g=p.querySelector(".simpay-".concat(v,"-address-container .simpay-address-element"));if(g){var h={line1:null!==(t=g.dataset.defaultLine1)&&void 0!==t?t:null,line2:null!==(r=g.dataset.defaultLine2)&&void 0!==r?r:null,city:null!==(n=g.dataset.defaultCity)&&void 0!==n?n:null,state:null!==(o=g.dataset.defaultState)&&void 0!==o?o:null,postal_code:null!==(u=g.dataset.defaultPostalCode)&&void 0!==u?u:null,country:null!==(l=g.dataset.defaultCountry)&&void 0!==l?l:null};Object.keys(h).forEach((function(e){h[e]||delete h[e]}));var b=f.create("address",{mode:v,fields:{phone:"never"},defaultValues:{address:h},allowedCountries:g.dataset.allowedCountries?JSON.parse(g.dataset.allowedCountries):[]});b.mount(g),d(i()({},"".concat(v,"AddressElement"),b));var O=Object(a.d)((function(t){d(i()({},"".concat(v,"Address"),c(c({complete:t.complete},y["".concat(v,"Address")]),t.value))),t.complete&&e.trigger("totalChanged",[e])}),500);b.on("change",(function(e){s(p),O(e)}))}}},function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return s}));var n=r(0),i=r.n(n);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){var r=e.querySelector(".simpay-email-error");if(r){var n=e.i18n.emptyEmailError;r.innerText=t||n,r.style.display="block",wp.a11y.speak(n,"assertive")}}function u(e){var t=e.querySelector(".simpay-email-error");t&&(t.innerText="",t.style.display="none")}function s(e){var t=e.state.linkAuthenticationElement;return!t||!!t.complete||(t.focus(),!1)}t.a=function(e){var t=e.paymentForm;t.querySelector(".simpay-link-authentication-container")?function(e){var t,r=e.setState,n=e.state,i=e.stripeElements,a=n.paymentElement,c=e.querySelector(".simpay-link-authentication-container"),u=i.create("linkAuthentication",{defaultValues:{email:null!==(t=c.dataset.default)&&void 0!==t?t:null}});r({linkAuthenticationElement:u});var s=e.querySelector(".simpay-email");u.on("change",(function(e){var t=e.complete,n=e.value;s.value=n.email,r({email:n.email,linkAuthenticationElement:o(o({},u),{},{complete:t})}),t&&a.update({defaultValues:{billingDetails:{email:n.email}}})})),u.mount(c)}(t):function(e){var t=e.setState,r=e.state.paymentElement,n=e.querySelector(".simpay-email");n&&(n.addEventListener("blur",(function(e){var n=e.target;t({email:n.value}),r&&r.update({defaultValues:{billingDetails:{email:n.value}}})})),n.dispatchEvent(new Event("blur")))}(t)}},function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return s}));var n=r(0),i=r.n(n);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t){var r=e.querySelector(".simpay-phone-error");if(r){var n=e.i18n.invalidPhoneError;r.innerText=t||n,r.style.display="block",wp.a11y.speak(n,"assertive")}}function u(e){var t=e.querySelector(".simpay-phone-error");t&&(t.innerText="",t.style.display="none")}function s(e){var t=e.state.intlTelInput;if(!t)return!0;var r=e.querySelector(".simpay-telephone");return!r.required&&!r.value||t.isValidNumber()}t.a=function(e){var t=e.paymentForm,r=t.setState,n=t.querySelector(".simpay-telephone");if(n){if(n.addEventListener("blur",(function(e){var n=e.target;r({phone:n.value}),n.value&&!s(t)||u(t)})),window.simpayIntlTelInput){var i=window.intlTelInput(n,o(o({},window.simpayIntlTelInput),{},{hiddenInput:"simpay_telephone"}));r({intlTelInput:i})}n.dispatchEvent(new Event("blur"))}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(1).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var n=r(1),i=r.n(n);function a(e){!function(e){var t=e.querySelector(".simpay-subtotal-amount-value");if(t){var r=e.cart,n=e.convertToDollars,i=(0,e.formatCurrency)(r.isZeroDecimal()?r.getSubtotal():n(r.getSubtotal()),!0,r.getCurrencySymbol(),r.isZeroDecimal());t.innerText=i,e.querySelector(".simpay-subtotal-amount-container").style.display=r.getTotal()!==r.getSubtotal()||"automatic"===r.taxStatus?"block":"none"}}(e),function(e){var t=e.querySelector(".simpay-coupon-amount-container");if(t){var r=e.cart,n=e.convertToDollars,a=e.formatCurrency,o=r.getCoupon();if("object"===i()(o)){t.style.display="block";var c=a(r.isZeroDecimal()?r.getDiscount():n(r.getDiscount()),!0,r.getCurrencySymbol(),r.isZeroDecimal());e.querySelector(".simpay-coupon-amount-name").innerText=o.id,e.querySelector(".simpay-coupon-amount-value").innerText="-".concat(c)}else t.style.display="none"}}(e),function(e){var t=e.cart,r=e.convertToDollars,n=e.formatCurrency,i=e.state,a=t.automaticTax;if(e.querySelector(".simpay-tax-amount-container"))switch(t.taxStatus){case"none":return;case"automatic":var o=e.settings.addressType,c=i["".concat(o,"Address")];c&&c.complete&&(e.querySelector(".simpay-automatic-tax-label .simpay-tax-amount-value").innerText=n(t.isZeroDecimal()?a.amount_tax:r(a.amount_tax),!0,t.getCurrencySymbol(),t.isZeroDecimal()));break;default:var u=t.getAppliedTaxRates();Object.values(u).forEach((function(i,a){var o=i.reduce((function(e,t){return e+t}),0),c=n(t.isZeroDecimal()?o:r(o),!0,t.getCurrencySymbol(),t.isZeroDecimal());e.querySelector(".simpay-tax-amount-value-".concat(Object.keys(u)[a])).innerText=c}))}}(e),function(e){var t=e.querySelectorAll(".simpay-total-amount-value");if(0!==t.length){var r=e.cart,n=e.convertToDollars,i=(0,e.formatCurrency)(r.isZeroDecimal()?r.getTotalDueToday():n(r.getTotalDueToday()),!0,r.getCurrencySymbol(),r.isZeroDecimal());t.forEach((function(e){return e.innerHTML=i}))}}(e),function(e){var t,r=e.querySelector(".simpay-fee-recovery-container");if(r){var n=e.querySelector(".simpay-fee-recovery-amount-value"),i=e.cart,a=e.convertToDollars,o=e.formatCurrency,c=e.state.paymentMethod,u=i.getTotalDueToday({includeFeeRecovery:!1}),s=0===u?i.getNextInvoiceTotal({includeFeeRecoveryFee:!1}):u;r.style.display=null!==(t=c.config)&&void 0!==t&&t.fee_recovery?"block":"none",s=o(i.isZeroDecimal()?i.getFeeRecoveryForAmount(s):a(i.getFeeRecoveryForAmount(s)),!0,i.getCurrencySymbol(),i.isZeroDecimal()),n.innerText=s}}(e),function(e){var t=e.querySelector(".simpay-total-amount-recurring-container");if(t)if(e.cart.isRecurring()){var r=function(e){var t,r,n,i,a=e.cart,o=e.convertToDollars,c=e.formatCurrency,u=e.i18n,s=u.recurringIntervals,l=u.recurringIntervalDisplay,p=u.recurringIntervalDisplayLimitedDiscount,m=u.recurringIntervalDisplayAutomaticTaxDiscount,d=u.recurringIntervalDisplayInvoiceLimit,y=u.recurringIntervalDisplayInvoiceLimitWithCoupon,f=e.settings,v=a.coupon,g=a.taxStatus;"no"===f.allowMultipleLineItem?n=a.getLineItem("base"):n=null!==(i=a.getLineItems().find((function(e){var t;return e.checked&&(null===(t=e.price)||void 0===t||null===(t=t.recurring)||void 0===t?void 0:t.interval)})))&&void 0!==i?i:a.getLineItem("base");var h,b=null!==(t=null===(r=n.price)||void 0===r||null===(r=r.recurring)||void 0===r?void 0:r.invoice_limit)&&void 0!==t?t:void 0,O=n.price.recurring.interval,_=n.price.recurring.interval_count,S=s[O],x=c(a.isZeroDecimal()?a.getNextInvoiceTotal():o(a.getNextInvoiceTotal()),!0,a.getCurrencySymbol(),a.isZeroDecimal());if(b)return(h=v&&"forever"!==v.duration?y:d).replace("%1$d",b).replace("%2$s",x).replace("%3$s",1===_?"":_).replace("%4$s",1===_?S[0]:S[1]);var j=c(a.isZeroDecimal()?a.getRecurringNoDiscountTotal():o(a.getRecurringNoDiscountTotal()),!0,a.getCurrencySymbol(),a.isZeroDecimal());return h=(h=(h=v&&"repeating"===v.duration&&v.duration_in_months>=function(e,t){switch(e){case"day":return t/30;case"week":return t/4;case"month":return t;case"year":return 12}}(O,_)?"automatic"===g?m.replace("%1$s",x):p.replace("%1$s",x):v&&"once"===v.duration?l.replace("%1$s",j):v&&"forever"===v.duration?l.replace("%1$s",x):l.replace("%1$s",j)).replace("%2$s",1===_?"":_)).replace("%3$s",1===_?S[0]:S[1]),v&&v.duration_in_months&&(h=h.replace("%4$s",v.duration_in_months)),h.replace("%5$s",l.replace("%1$s",j).replace("%2$s",1===_?"":_).replace("%3$s",1===_?S[0]:S[1]))}(e);e.querySelector(".simpay-total-amount-recurring-value").innerText=r,t.style.display="block"}else t.style.display="none"}(e)}t.a=function(e){var t=e.paymentForm;e.on("totalChanged",(function(){a(t)})),a(t)}},,function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(13);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(8);function i(e){var t=e.cart,r=e.convertToDollars,n=e.formatCurrency,i=e.i18n,a=i.paymentButtonText,o=i.paymentButtonTrialText,c=e.querySelector(".simpay-payment-btn");if(c){var u;if(c.disabled=!1,c.classList.remove("simpay-disabled"),t.hasFreeTrial())u=o;else{var s=n(t.isZeroDecimal()?t.getTotalDueToday():r(t.getTotalDueToday()),!0,t.getCurrencySymbol(),t.isZeroDecimal()),l='<em class="simpay-total-amount-value">'.concat(s,"</em>");u=a.replace("{{amount}}",l)}c.querySelector("span").innerHTML=u}}function a(e){var t=e.i18n.paymentButtonLoadingText,r=e.querySelector(".simpay-payment-btn");r&&(r.disabled=!0,r.classList.add("simpay-disabled"),r.querySelector("span").innerText=t)}t.a=function(e){Object(n.a)("simpayEnablePaymentForm","wpsp/paymentForm",i),Object(n.a)("simpayDisablePaymentForm","wpsp/paymentForm",a)}},,,function(e,t,r){var n=r(20);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,r){var n=r(20);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},,,,function(e,t,r){"use strict";(function(e){var n=r(0),i=r.n(n),a=r(8),o=r(42),c=r(41),u=r(22),s=r(2),l=r(37),p=r(38),m=r(39),d=r(14),y=r(26);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=window.simplePayForms;t.a=function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.formId=parseInt(t.dataset.simpayFormId),r||(r=g[t.formId]),t=Object.assign(t,r),window.spShared={convertToDollars:s.c,convertToCents:s.b,formatCurrency:s.e,unformatCurrency:s.m},t.state={price:Object(s.g)(t),paymentMethod:Object(s.f)(t),customAmount:null,taxAmount:0,couponCode:null},t.setState=function(e){t.state=v(v({},t.state),e)},t.enable=p.a.bind(t),t.disable=m.a.bind(t),t.error=l.a.bind(t),t.convertToCents=s.b.bind(t),t.convertToDollars=s.c.bind(t),t.formatCurrency=s.e.bind(t),t.unformatCurrency=s.m.bind(t),t.getPaymentMethodTypes=s.j.bind(t),t.getPaymentMethodOptions=s.i.bind(t),t.getToken=s.k.bind(t),t.disable(),t.cart=Object(s.l)(new o.a({paymentForm:t}),t),t.stripejs=Stripe(t.stripe.apiKey,{apiVersion:t.stripe.apiVersion,locale:t.stripe.elementsLocale,betas:["elements_enable_deferred_intent_beta_1"]}),t.stripeElements=t.stripejs.elements(v(v({},Object(s.h)(t.stripe.elements)),{},{setupFutureUsage:t.cart.isRecurring()?"off_session":null,mode:t.cart.isRecurring()?"subscription":"payment",amount:0!==t.cart.getTotalDueToday()?t.cart.getTotalDueToday():t.cart.getLineItem("base").price.unit_amount,currency:t.cart.getCurrency(),paymentMethodTypes:t.getPaymentMethodTypes(),paymentMethodOptions:t.getPaymentMethodOptions()}));var n=e(t);return n.paymentForm=t,n.cart=t.cart,n.state=t.state,n.setState=t.setState,n.enable=t.enable,n.disable=t.disable,n.error=t.error,n.on("totalChanged",(function(){Object(d.b)(t),Object(y.b)(t),Object(s.a)(t).then((function(){return Object(u.b)(t)}))})),Object(c.a)(n),Object(a.b)("simpaySetupPaymentForm",n),e(document.body).trigger("simpayCoreFormVarsInitialized",[n]).trigger("simpayBindCoreFormEventsAndTriggers",[n]).trigger("simpaySetupCoreForm",[n]),n}}).call(this,r(9))},function(e,t,r){"use strict";(function(e){t.a=function(t){var r,n=this.i18n,i=n.stripeErrorMessages,a=n.unknownError;if(t&&""===t)r="";else if(void 0!==t){var o=t.message,c=t.code;r=o||t,c&&i[c]&&(r=i[c])}else r=a;var u=this.querySelector(".simpay-generic-error");u.style.display="block",e(u).html(r),wp.a11y.speak(r,"assertive")}}).call(this,r(9))},function(e,t,r){"use strict";var n=r(8);t.a=function(){this.classList.remove("simpay-checkout-form--loading"),this.querySelectorAll("input, select, textarea").forEach((function(e){return e.readOnly=!1})),Object(n.b)("simpayEnablePaymentForm",this)}},function(e,t,r){"use strict";var n=r(8);t.a=function(){this.classList.add("simpay-checkout-form--loading"),this.querySelectorAll("input, select, textarea").forEach((function(e){return e.readOnly=!0})),Object(n.b)("simpayDisablePaymentForm",this)}},function(e,t,r){"use strict";var n=r(1),i=r.n(n);function a(e){var t=!1;"object"===i()(e)?(e.preventDefault(),t=e.target.dataset.formId):t=e;var r=document.querySelectorAll('.simpay-modal[data-form-id="'+t+'"]');0!==r.length&&(r=r[r.length-1],document.body.appendChild(r),"0"!==getComputedStyle(r).getPropertyValue("opacity")?(r.style.opacity=0,r.style.height=0):(r.style.opacity=1,r.style.height="100%",function(e){var t=["button:not([disabled])",'input:not([type="hidden"]):not([aria-hidden]):not([disabled])',"select:not([disabled])","textarea:not([disabled])"].join(","),r=e.querySelector(t);r&&(r.focus(),r.parentElement.classList.add("is-focused"))}(r)))}var o=!1;t.a=function(){if(!0!==o){o=!0;var e=document.querySelectorAll("input.simpay-modal-control"),t=document.querySelectorAll("*:not(input).simpay-modal-control");e.forEach((function(e){e.addEventListener("change",a)})),t.forEach((function(e){e.addEventListener("click",a)}))}}},function(e,t,r){"use strict";var n=r(12),i=r(0),a=r.n(i),o=r(5),c=r.n(o);function u(e){var t=e.closest(".simpay-price-selection-label").querySelector(".simpay-quantity-field-input");return t?parseInt(t.value,10):1}function s(e){var t=e.closest(".simpay-price-selection-label").querySelector(".simpay-recurring-amount-toggle");return!!t&&t.checked}function l(e,t){var r=e.closest(".simpay-price-selection-label").querySelector(".simpay-custom-amount-error");r&&(r.innerHTML=t,r.style.display="block")}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t){if("radio"===e.type)!function(e,t){var r=t.paymentForm,n=e.closest(".simpay-price-selection-label"),i=r.querySelectorAll(".simpay-quantity-field"),a=r.querySelectorAll(".simpay-recurring-amount-toggle-container");if(i.forEach((function(e){e.style.display="none"})),a.forEach((function(e){e.style.display="none"})),n){var o=n.querySelector(".simpay-quantity-field");if(o){var c=n.querySelector(".simpay-recurring-amount-toggle-container");o&&(o.style.display="flex"),c&&(c.style.display="flex")}}}(e,t);else{var r=e.closest(".simpay-price-selection-label");if(!r)return;var n=r.querySelector(".simpay-additional-fields");if(!n)return;n.style.display=e.checked?"flex":"none"}}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t){var r=t.paymentForm,n=r.cart,i=r.error,a=r.setState,o=r.settings,l=JSON.parse(e.dataset.price);i("");var p=l.id,m=l.can_recur,d=l.recurring,y=l.line_items,v=l.unit_amount,g=(d||{}).trial_period_days,h=void 0!==g&&g,b=n.getLineItem("base"),O=f(f({},b),{},{amount:parseInt(v),title:l.label||l.generated_label,price:l});if(O.subscription=!(!d||!1!==m)&&{isTrial:!!d.trial_period_days&&parseInt(d.trial_period_days),interval:d.interval,intervalCount:parseInt(d.interval_count)},b.update(O),"yes"!==o.allowMultipleLineItem){var _=n.getLineItem("setup-fee"),S=n.getLineItem("plan-setup-fee");_.update(f(f({},_),{},{amount:y&&y[0]&&!1===m?parseInt(y[0].unit_amount):0})),S.update(f(f({},S),{},{amount:y&&y[1]&&!1===m?parseInt(y[1].unit_amount):0}));var x=p.startsWith("simpay_");a({price:l,isCustomAmount:x,customAmount:x?v:null,isTrial:h}),t.trigger("simpayMultiPlanChanged",[l,t])}else{var j=r.querySelectorAll('[name="simpay_price"]');!function(e,t){var r=JSON.parse(e.dataset.price);function n(e){return e.recurring&&e.recurring.interval}n(r)&&t.forEach((function(e){if(n(JSON.parse(e.dataset.price))){var t=JSON.parse(e.dataset.price);t.id!==r.id&&(r.recurring.interval===t.recurring.interval&&r.recurring.interval_count===t.recurring.interval_count||(e.checked=!1))}}))}(e,j),function(e,t){var r=JSON.parse(e.dataset.price);t.forEach((function(e){JSON.parse(e.dataset.price).currency!==r.currency&&(e.checked=!1)}))}(e,j),function(e,t){c()(t).find((function(e){return e.checked}))||(e.checked=!0)}(e,j);var P={};j.forEach((function(e){var t=JSON.parse(e.dataset.price),r=t.id,i=t.generated_label,a=t.unit_amount,o=t,c=e.checked,l=n.getBaseItemPriceId()===r,p=Number.parseInt(a,10)||0,m=t.line_items||[],d=u(e);c?(P={id:l?"base":r,title:i,amount:p,quantity:d,price:o,checked:!0,fees:m,isOptionallyRecurring:s(e)},l?n.updateLineItem(r,P):n.addLineItem(P)):function(e,t,r,n,i,a,o){if(i){var c={id:"base",title:t,amount:0,quantity:1,price:r,checked:!1,fees:a,isOptionallyRecurring:o};n.updateLineItem(e,c)}else n.removeLineItem(e)}(r,i,o,n,l,m,s(e)),n.removeDuplicateLineItems()}))}t.trigger("totalChanged",[t])}var g=r(16);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e){var t=e.paymentForm,r=t.cart,n=t.settings,i=r.getLineItem("base").price.can_recur,a=t.querySelector(".simpay-recurring-amount-toggle-container");if(a){var o=t.querySelector(".simpay-recurring-amount-toggle");o&&o.checked&&_(o,e),t.setState({isOptionallyRecurring:o.checked}),"yes"!==n.allowMultipleLineItem&&(a.style.display=i?"block":"none")}}function _(e,t){var r=t.paymentForm,n=r.cart,i=r.setState,a=r.stripeElements,o=n.getLineItem("base"),c=o.price,u=c.recurring,s=c.line_items;if(u){var l=!0===e.checked&&{isTrial:!!u.trial_period_days&&parseInt(u.trial_period_days),interval:u.interval,intervalCount:parseInt(u.interval_count)};o.update(b(b({},o),{},{subscription:l,isOptionallyRecurring:e.checked}));var p=n.getLineItem("setup-fee"),m=n.getLineItem("plan-setup-fee");p.update(b(b({},p),{},{amount:!0===e.checked&&s&&s[0]?parseInt(s[0].unit_amount):0})),m.update(b(b({},m),{},{amount:!0===e.checked&&s&&s[1]?parseInt(s[1].unit_amount):0})),i({isOptionallyRecurring:e.checked}),e.checked&&a.update({mode:"subscription"}),t.trigger("totalChanged",[t])}}var S=r(22);function x(e){var t=e.paymentForm;if("yes"!==t.settings.allowMultipleLineItem){var r=1;t.querySelector(".simpay-quantity-dropdown")?(r=parseFloat(e.find(".simpay-quantity-dropdown").find("option:selected").data("quantity")),e.trigger("simpayDropdownQuantityChange")):t.querySelector(".simpay-quantity-radio")?(r=parseFloat(e.find(".simpay-quantity-radio").find('input[type="radio"]:checked').data("quantity")),e.trigger("simpayRadioQuantityChange")):t.querySelector(".simpay-quantity-input")&&(r=parseFloat(e.find(".simpay-quantity-input").val()),e.trigger("simpayNumberQuantityChange")),r<1&&(r=1);try{t.cart.getLineItem("base").update({quantity:r}),t.querySelector(".simpay-quantity").value=r,e.trigger("totalChanged",[e])}catch(e){}}}function j(e,t){(0,e.paymentForm.setState)({isCoveringFees:t}),e.trigger("totalChanged",[e])}var P=r(17),w=r(7);function T(e){var t=e.paymentForm,r=t.cart,n=t.disable,i=t.enable,a=t.formId,o=t.setState,c=t.querySelector(".simpay-coupon-field"),u=c.value,s=t.state;""!==u&&(function(e){var t=e.querySelector(".simpay-coupon-error");t.innerText="",t.style.display="none"}(t),n(),window.wp.apiFetch({url:window.spGeneral.strings.wpJsonUrl+"wpsp/__internal__/payment/validate-coupon",method:"POST",data:{coupon_code:u,form_id:a,currency:r.getCurrency(),subtotal:r.getSubtotal(),price_id:r.getLineItem("base").price.id,is_optionally_recurring:s.isOptionallyRecurring}}).then((function(n){var i=n.message,a=n.coupon;o({coupon:u}),r.update({coupon:a}),t.querySelector(".simpay-coupon-info").style.display="block",t.querySelector(".simpay-coupon-message").innerText=Object(w.a)(i),wp.a11y.speak(i,"polite"),e.trigger("simpayCouponApplied")})).catch((function(e){var r=e.message;!function(e,t){var r=e.querySelector(".simpay-coupon-error");r.innerText=t,r.style.display="block",wp.a11y.speak(t,"assertive")}(t,r)})).finally((function(){c.value="",e.trigger("totalChanged",[e]),i()})))}function k(e){var t=e.paymentForm;t.querySelector(".simpay-coupon-info").style.display="none",t.querySelector(".simpay-coupon-message").innerText="",t.cart.update({coupon:!1}),t.setState({coupon:!1}),e.trigger("simpayCouponRemoved"),e.trigger("totalChanged",[e])}var I=r(18),D=r(19),q=r(14),F=r(26);t.a=function(e){var t,r,i,a;Object(g.a)(e),function(e){var t=e.paymentForm,r=t.settings,n=t.querySelector(".simpay-plan-select-container");if(n){var i,a=n.dataset.displayType,o=t.querySelectorAll('[name="simpay_price"]');"yes"===r.allowMultipleLineItem&&(a="radio"),i="dropdown"===a?":selected":":checked";var c=e.find(".simpay-plan-wrapper ".concat(i))[0];c||("dropdown"===a?(c=n.querySelector("option:not([disabled])")).selected=!0:(c=n.querySelector('input:not([disabled]):not([type="number"])')).checked=!0),o.forEach((function(t){d(t,e),t.addEventListener("change",(function(t){var r=t.target;v("dropdown"===a?r.options[r.selectedIndex]:r,e)}))})),v(c,e),"yes"===r.allowMultipleLineItem&&(function(e){var t=e.paymentForm.querySelectorAll(".simpay-quantity-field-input");t&&t.forEach((function(t){t.addEventListener("change",(function(t){v(t.target.closest(".simpay-price-selection-label").querySelector('[name="simpay_price"]'),e)}))}))}(e),function(e){var t=e.paymentForm,r=t.cart,n=t.i18n,i=t.unformatCurrency,a=t.formatCurrency,o=t.convertToCents,c=t.convertToDollars,s=t.querySelectorAll(".simpay-custom-amount-input");s&&s.forEach((function(t){var s=t.closest(".simpay-price-selection-label").querySelector('[name="simpay_price"]');s&&t&&t.addEventListener("input",(function(p){var d=p.target,y=JSON.parse(s.dataset.price).id,f=r.getBaseItemPriceId()===y?"base":y,v=r.getLineItem(f),g=v.price.is_zero_decimal?i(d.value):o(i(d.value));if(g<v.price.unit_amount_min){var h=parseInt(v.price.unit_amount_min),b=a(v.price.is_zero_decimal?h:c(h),!0,r.getCurrencySymbol(),v.price.is_zero_decimal),O=n.minCustomAmountError.replace("%s",b);l(t,O)}else if(v.price.unit_amount_max&&g>v.price.unit_amount_max){var _=parseInt(v.price.unit_amount_max),S=a(v.price.is_zero_decimal?_:c(_),!0,r.getCurrencySymbol(),v.price.is_zero_decimal),x=n.maxCustomAmountError.replace("%s",S);l(t,x)}else{!function(e){var t=e.closest(".simpay-price-selection-label").querySelector(".simpay-custom-amount-error");t&&(t.innerHTML="",t.style.display="none")}(t);var j=m(m({},v),{},{id:f,amount:g,quantity:u(s),checked:!0});r.updateLineItem(y,j),s.dataset.price=JSON.stringify(m(m({},v.price),{},{unit_amount:j.amount})),e.trigger("totalChanged",[e])}}))}))}(e),function(e){var t=e.paymentForm.querySelectorAll(".simpay-recurring-amount-toggle");t&&t.forEach((function(t){t.addEventListener("change",(function(t){v(t.target.closest(".simpay-price-selection-label").querySelector('[name="simpay_price"]'),e)}))}))}(e),e.on("totalChanged",(function(){o.forEach((function(t){d(t,e)}))})))}}(e),function(e){var t=e.paymentForm.settings;e.on("simpayMultiPlanChanged",(function(){return O(e)})),O(e),"yes"!==t.allowMultipleLineItem&&function(e){var t=e.paymentForm.querySelector(".simpay-recurring-amount-toggle");t&&t.addEventListener("change",(function(t){_(t.target,e)}))}(e)}(e),Object(S.a)(e),function(e){x(e),e.find(".simpay-quantity-radio input, .simpay-quantity-dropdown, .simpay-quantity-input").on("input",(function(){return x(e)})),e.on("totalChanged",(function(){return function(e){var t=e.paymentForm,r=t.querySelector('input.simpay-quantity-input[type="number"]');if(r){var n=t.state.price;n.inventory&&(r.max=n.inventory)}}(e)}))}(e),function(e){var t=e.paymentForm.querySelector(".simpay-fee-recovery-toggle");j(e,!t||t&&t.checked),function(e){var t=e.paymentForm,r=t.querySelector(".simpay-fee-recovery-toggle");r&&r.addEventListener("change",(function(r){var n=r.target;j(e,n.checked);var i=t.querySelector(".simpay-fee-recovery-container");i&&(i.style.display=n.checked?"block":"none")}))}(e)}(e),Object(P.a)(e),function(e){e.paymentForm.querySelector(".simpay-coupon-field")&&(function(e){var t=e.paymentForm;t.querySelector(".simpay-apply-coupon").addEventListener("click",(function(){return T(e)}));var r=t.querySelector(".simpay-coupon-field");""!==r.value&&T(e),r.addEventListener("keypress",(function(t){if(13===t.which)return t.preventDefault(),T(e)})),t.querySelector(".simpay-remove-coupon").addEventListener("click",(function(t){t.preventDefault(),k(e)}))}(e),e.on("totalChanged",(function(){return function(e){var t=e.paymentForm.cart,r=t.getLineItem("base").subscription,n=t.getCoupon();if(!1!==n){var i=t.getLineItem("base").price,a=i.currency_min_amount,o=i.unit_amount,c=t.getSubtotal()-t.getDiscount();!1!==r&&n.percent_off&&100===n.percent_off||(!1!==r&&c<a&&0!==c&&o>c&&c>0&&k(e),c<a&&!1===r&&k(e))}}(e)})))}(e),function(e){e.paymentForm.querySelector(".simpay-tax-id-container")&&function(e){var t=e.paymentForm,r=t.querySelector(".simpay-tax-id-type"),n=t.querySelector(".simpay-tax-id");r.addEventListener("change",(function(){n.value="",e.trigger("totalChanged",[e])})),n.addEventListener("blur",(function(){e.trigger("totalChanged",[e])}))}(e)}(e),Object(n.a)(e),Object(q.a)(e),Object(F.a)(e),Object(D.a)(e),t=e.paymentForm,r=t.setState,i=t.state.paymentElement,(a=t.querySelector(".simpay-customer-name"))&&(a.addEventListener("blur",(function(e){var t=e.target;r({name:t.value}),i.update({defaultValues:{billingDetails:{name:t.value}}})})),a.dispatchEvent(new Event("blur"))),Object(I.a)(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(5),i=r.n(n),a=r(1),o=r.n(a),c=r(0),u=r.n(c),s=r(24),l=r.n(s),p=r(25),m=r.n(p);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=function(){return m()((function e(t,r){if(l()(this,e),this.cart=null,this.id=null,this.title=null,this.amount=0,this.quantity=1,this.subscription=!1,this.price=null,this.checked=!1,this.fees=[],this.isOptionallyRecurring=!1,"object"!==o()(r))throw{id:"invalid-line-item-cart",message:"Item must have an cart."};this.cart=r,this.update(t)}),[{key:"update",value:function(e){var t=y(y({},this),e),r=t.id,n=t.title,i=t.amount,a=t.quantity,c=t.subscription,u=t.price,s=t.checked,l=t.fees,p=t.isOptionallyRecurring;if("string"!=typeof r)throw{id:"invalid-line-item-id",message:"Item ID must be a string."};if(this.id=r,"string"!=typeof n)throw{id:"invalid-line-item-title",message:"Item title must be a string."};if(this.title=n,!Number.isSafeInteger(i))throw{id:"invalid-line-item-amount",message:"Item amount must be an integer."};if(this.amount=i,!Number.isSafeInteger(a))throw{id:"invalid-line-item-quantity",message:"Item quantity must be an integer."};if(this.quantity=a,!1!==c&&"object"!==o()(c))throw{id:"invalid-line-item-subscription",message:"Item subscription data must be a false or contain subscription data."};return this.subscription=c,"object"===o()(u)&&null!==u?this.price=u:this.price=null,"boolean"==typeof s&&(this.checked=s),Array.isArray(l)&&(this.fees=l),"boolean"==typeof p&&(this.isOptionallyRecurring=p),this}},{key:"remove",value:function(){var e=this,t=this.cart.getLineItems().filter((function(t){var r=t.id;return e.id!==r}));return this.cart.items=t,this}},{key:"getUnitPrice",value:function(){return this.amount}},{key:"getFees",value:function(){var e=0;return this.checked&&this.fees.length>0&&(this.price.can_recur&&this.isOptionallyRecurring||!this.price.can_recur&&this.price.recurring)&&this.fees.forEach((function(t){e+=t.unit_amount})),e}},{key:"getQuantity",value:function(){return this.quantity}},{key:"getDiscount",value:function(){var e=this.cart.getDiscount();if(0===e)return 0;var t=this.cart.getLineItems().filter((function(e){return!e.hasFreeTrial()&&0!==e.getUnitPrice()}));return Math.round(e/t.length)}},{key:"getSubtotal",value:function(){if(this.hasFreeTrial())return 0;var e=this.getUnitPrice()*this.getQuantity()+this.getFees();return 0===e?e:this.cart.coupon.amount_off&&"setup-fee"!==this.id&&e<=this.getDiscount()?0:Math.round(e-this.getDiscount())}},{key:"getInclusiveTaxAmount",value:function(){var e=this.cart.getTaxPercent("inclusive")/100,t=this.getSubtotal(),r=Math.round(t-t/(1+e));return Math.round(t-(t-r))}},{key:"getTaxableAmount",value:function(){var e=this.getSubtotal(),t=this.getInclusiveTaxAmount();return Math.round(e-t)}},{key:"getTax",value:function(){if("automatic"===this.cart.taxStatus||"none"===this.cart.taxStatus)return 0;var e=this.getTaxableAmount(),t=this.cart.getTaxPercent("exclusive");return Math.round(e*(t/100))}},{key:"getTotal",value:function(){return this.getSubtotal()+this.getTax()}},{key:"hasFreeTrial",value:function(){var e=this.price;return!!e&&(!!(e.can_recur&&this.isOptionallyRecurring&&e.recurring&&e.recurring.trial_period_days)||!e.can_recur&&e.recurring&&e.recurring.trial_period_days)}}])}();function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={includeFeeRecovery:!0},b=function(){function e(t){l()(this,e),this.LineItem=f,this.paymentForm=null,this.items=[],this.currency="usd",this.taxPercent=0,this.taxRates=[],this.taxStatus="fixed-global",this.taxBehavior="exclusive",this.automaticTax={},this.coupon=!1,this.isNonDecimalCurrency=!1,this.update(t)}return m()(e,[{key:"update",value:function(e){var t=g(g({},this),e),r=t.paymentForm,n=t.currency,i=t.taxPercent,a=t.taxRates,c=t.taxStatus,u=t.taxBehavior,s=t.automaticTax,l=t.coupon,p=t.isNonDecimalCurrency;if(this.paymentForm=r,"string"!=typeof n)throw{id:"invalid-currency",message:"Currency must be a string."};if(this.currency=n,isNaN(i))throw{id:"invalid-tax-percent",message:"Tax percentage must be a number."};if(this.taxPercent=parseFloat(i),a&&Array.isArray(a)&&(this.taxRates=a),c&&"string"==typeof c&&(this.taxStatus=c),u&&"string"==typeof u&&(this.taxBehavior=u),s&&"object"===o()(s)&&(this.automaticTax=s),!1!==l&&"object"!==o()(l))throw{id:"invalid-coupon",message:"Coupon must be a false or contain coupon data."};if(this.coupon=l,"boolean"!=typeof p)throw{id:"invalid-non-decimal-currency",message:"Declaring a non-decimal currency must be a boolean."};return this.isNonDecimalCurrency=p,this}},{key:"reset",value:function(){return new e}},{key:"getCurrency",value:function(){var e;return(null===(e=this.getLineItem("base"))||void 0===e||null===(e=e.price)||void 0===e?void 0:e.currency)||""}},{key:"getCurrencySymbol",value:function(){var e;return(null===(e=this.getLineItem("base"))||void 0===e||null===(e=e.price)||void 0===e?void 0:e.currency_symbol)||""}},{key:"isZeroDecimal",value:function(){return this.getLineItem("base").price.is_zero_decimal}},{key:"getCoupon",value:function(){return this.coupon}},{key:"getTaxPercent",value:function(e){return this.getTaxRates().reduce((function(t,r){var n=r.calculation,i=r.percentage;return e!==n?t:t+i}),0)}},{key:"getTaxDecimal",value:function(){return this.taxPercent/100}},{key:"getTaxRates",value:function(){return this.taxRates}},{key:"getLineItems",value:function(){return this.items}},{key:"getSubtotal",value:function(){return this.getLineItems().reduce((function(e,t){return t.hasFreeTrial()?e:e+Math.round(t.getUnitPrice()*t.getQuantity())}),0)}},{key:"getDiscount",value:function(){var e=this.getCoupon(),t=e.percent_off,r=e.amount_off,n=0;return!1===e||(t?n+=Math.round(this.getSubtotal()*(t/100)):r&&(n+=r)),n}},{key:"getTax",value:function(){return"none"===this.taxStatus?0:this.getLineItems().reduce((function(e,t){return e+t.getTax()}),0)}},{key:"getAppliedTaxRates",value:function(){if("none"===this.taxStatus)return{};var e=this.getLineItems(),t=this.getTaxRates().filter((function(e){return"inclusive"!==e.calculation})),r=this.getTaxPercent("exclusive")/100,n=this.getTaxRates().filter((function(e){return"exclusive"!==e.calculation})),a=this.getTaxPercent("inclusive")/100,o={};return e.forEach((function(e){if(!e.hasFreeTrial()){var c=e.getTax(),u=e.getTaxableAmount(),s=e.getInclusiveTaxAmount();t.forEach((function(e,n){var a=e.id,s=e.percentage/100,l=0;if(n===t.length-1){var p=t.filter((function(e){return e.id!==a})).reduce((function(e,t){return e+t.percentage}),0)/100,m=Math.floor(u*p);l=c-m}else l=Math.floor(c*(s/r));o[a]=[].concat(i()(o[a]||[]),[l])})),n.forEach((function(e,t){var r,c=e.id,u=e.percentage/100;if(t===n.length-1){var l=n.filter((function(e){return e.id!==c})).reduce((function(e,t){var r=t.percentage;return e+Math.floor(s*(r/100/a))}),0);r=s-l}else r=Math.floor(s*(u/a));o[c]=[].concat(i()(o[c]||[]),[r])}))}})),o}},{key:"getTotal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=this.getLineItems().reduce((function(e,t){return e+t.getTotal()}),0),r=e.includeFeeRecovery?this.getFeeRecoveryForAmount(t):0;return t+r}},{key:"getTotalDueToday",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=0;"exclusive"===this.taxBehavior&&this.automaticTax&&0!==this.getSubtotal()&&(t=parseInt(this.automaticTax.amount_tax||t));var r=this.getLineItems().reduce((function(e,t){var r=0;return null!=t&&t.fees&&t.fees.length>0&&t.checked&&(r=t.fees.reduce((function(e,t){return e+t.unit_amount}),0)),t.hasFreeTrial()?e+r:e+t.getTotal()}),t),n=0!==r&&e.includeFeeRecovery?this.getFeeRecoveryForAmount(r):0;return r+n}},{key:"getRecurringTotal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=this.getLineItems().reduce((function(e,t){var r,n;return null!==(r=t.price)&&void 0!==r&&null!==(r=r.recurring)&&void 0!==r&&r.interval?null!==(n=t.price)&&void 0!==n&&n.can_recur&&!0===t.price.can_recur&&!1===t.isOptionallyRecurring?e:e+t.getUnitPrice()*t.getQuantity():e}),0);t=Math.round(t-this.getDiscount());var r=this.getTaxRates(),n=this.getTaxPercent("inclusive")/100,i=Math.round(t-t/(1+n)),a=Math.round(t-i),o=r.reduce((function(e,t){var r=t.percentage;return"inclusive"===t.calculation?e:e+Math.round(a*(r/100))}),0),c=Math.round(t+o),u=e.includeFeeRecovery?this.getFeeRecoveryForAmount(c):0;return c+u}},{key:"getRecurringNoDiscountTotal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=this.getLineItems().reduce((function(e,t){var r,n;return null!==(r=t.price)&&void 0!==r&&null!==(r=r.recurring)&&void 0!==r&&r.interval?null!==(n=t.price)&&void 0!==n&&n.can_recur&&!0===t.price.can_recur&&!1===t.isOptionallyRecurring?e:e+t.getUnitPrice()*t.getQuantity():e}),0),r=0;if("automatic"!==this.taxStatus&&"none"!==this.taxStatus){var n=this.getTaxRates(),i=this.getTaxPercent("inclusive")/100,a=Math.round(t-t/(1+i)),o=Math.round(t-a);r=n.reduce((function(e,t){var r=t.percentage;return"inclusive"===t.calculation?e:e+Math.round(o*(r/100))}),0)}else if("automatic"===this.taxStatus&&"exclusive"===this.taxBehavior&&this.automaticTax){var c;r=(null===(c=this.automaticTax.upcomingInvoice)||void 0===c?void 0:c.amount_tax)||0}var u=Math.round(t+r),s=e.includeFeeRecovery?this.getFeeRecoveryForAmount(u):0;return u+s}},{key:"getNextInvoiceTotal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=this.getCoupon(),r=t.percent_off,n=t.amount_off,i=t.duration,a=this.getLineItems().reduce((function(e,t){var r;return null!==(r=t.price)&&void 0!==r&&null!==(r=r.recurring)&&void 0!==r&&r.interval?e+t.getUnitPrice()*t.getQuantity():e}),0);if(t&&"once"!==i){var o=0;r?o+=Math.round(a*(r/100)):n&&(o+=n),a=Math.round(a-o)}var c=0;if("automatic"!==this.taxStatus&&"none"!==this.taxStatus){var u=this.getTaxRates(),s=this.getTaxPercent("inclusive")/100,l=Math.round(a-a/(1+s)),p=Math.round(a-l);c=u.reduce((function(e,t){var r=t.percentage;return"inclusive"===t.calculation?e:e+Math.round(p*(r/100))}),0)}else if("automatic"===this.taxStatus&&"exclusive"===this.taxBehavior&&this.automaticTax){var m;c=(null===(m=this.automaticTax.upcomingInvoice)||void 0===m?void 0:m.amount_tax)||0}var d=Math.round(a+c),y=e.includeFeeRecovery?this.getFeeRecoveryForAmount(d):0;return d+y<0?0:d+y}},{key:"getLineItem",value:function(e){var t=this.getLineItems().filter((function(t){return t.id===e}));if(0===t.length)throw{id:"invalid-line-item",message:'Unable to retrieve line item "'.concat(e,'"')};return t[0]}},{key:"addLineItem",value:function(e){var t;return t=1==e instanceof f?e:new this.LineItem(e,this),this.items.push(t),t}},{key:"updateLineItem",value:function(e,t){var r=this,n=this.getLineItems().map((function(n){return n.price&&n.price.id===e?new r.LineItem(t,r):n}));this.items=n}},{key:"getBaseItemPriceId",value:function(){return this.getLineItem("base").price.id}},{key:"removeLineItem",value:function(e){var t=this.getLineItems().filter((function(t){return t.id!==e}));this.items=t}},{key:"isLineItemExists",value:function(e){return this.getLineItems().filter((function(t){return t.id===e})).length>0}},{key:"removeDuplicateLineItems",value:function(){var e=this.getLineItems().filter((function(e,t,r){var n=e.id;return t===r.findIndex((function(e){return e.id===n}))}));this.items=e}},{key:"hasFreeTrial",value:function(){if("no"===this.paymentForm.settings.allowMultipleLineItem){var e,t,r,n=this.getLineItem("base");return!!(null!==(e=n.price)&&void 0!==e&&e.can_recur&&!0===n.isOptionallyRecurring||(null===(t=n.price)||void 0===t||!t.can_recur)&&null!==(r=n.price)&&void 0!==r&&r.recurring)&&n.hasFreeTrial()}return this.getLineItems().filter((function(e){var t=e.price,r=e.checked,n=e.isOptionallyRecurring;return(r&&(null==t?void 0:t.recurring)&&t.can_recur&&!0===n||r&&(null==t?void 0:t.recurring)&&!t.can_recur)&&t.recurring.trial_period_days})).length>0}},{key:"isRecurring",value:function(){if("no"===this.paymentForm.settings.allowMultipleLineItem){var e,t,r,n=this.getLineItem("base");return!(null!==(e=n.price)&&void 0!==e&&e.can_recur)&&(null===(t=n.price)||void 0===t?void 0:t.recurring)||(null===(r=n.price)||void 0===r?void 0:r.can_recur)&&n.isOptionallyRecurring}return this.getLineItems().filter((function(e){var t=e.price,r=e.checked,n=e.isOptionallyRecurring;return r&&(null==t?void 0:t.recurring)&&t.can_recur&&!0===n||r&&(null==t?void 0:t.recurring)&&!t.can_recur})).length>0}},{key:"getFeeRecoveryForAmount",value:function(e){var t=this.paymentForm.state,r=t.paymentMethod,n=t.isCoveringFees;if(!r||!r.config)return 0;var i=r.config.fee_recovery;if(!i||!n)return 0;var a=r.config.fee_recovery.max_amount,o=Math.round((e+parseInt(i.amount))/(1-parseFloat(i.percent)/100)-e);return a&&o>a?parseInt(a):o}},{key:"getPriceIds",value:function(){var e=[];return this.getLineItems().forEach((function(t){t.checked&&e.push({price_id:t.price.id,quantity:t.quantity,is_optionally_recurring:t.isOptionallyRecurring,custom_amount:t.amount,price_data:t.price})})),e}}])}()},function(e,t,r){"use strict";var n=r(3),i=r.n(n),a=r(7),o=r(12),c=function(e){var t=e.paymentForm,r=t.cart,n=t.state,i=t.stripejs,c=t.stripeElements,u=n.applePayPaymentMethod,s=n.clientSecret,l=n.email,p=n.isApplePay,m=n.name,d=n.phone,y=n.returnUrl;t.querySelectorAll(".simpay-form-control:not(.simpay-amounts-container):not(.simpay-card-container):not(.simpay-checkout-btn-container):not(.simpay-payment-btn-container):not(.simpay-link-authentication-container):not(.simpay-address-container-upe)").forEach((function(e){var t=e.querySelectorAll("input, textarea, select");e.classList.add("simpay-disabled"),t.forEach((function(e){e.disabled=!0,e.tabIndex=-1}))}));var f=0===r.getTotalDueToday()?"confirmSetup":"confirmPayment",v={clientSecret:s,confirmParams:{return_url:Object(a.a)(y)}};p?v.confirmParams.payment_method=u.id:(v.elements=c,v.confirmParams.payment_method_data={billing_details:{email:l,name:m,phone:d}}),i[f](v).then((function(e){var r=e.error;r&&(Object(o.d)(t,r.message),Object(o.b)(t))}))},u=r(17),s=r(16),l=r(18),p=r(19);function m(e){var t=e.paymentForm,r=t.cart,n=t.error,a=t.enable,o=t.formId,u=t.getToken,s=t.setState,l=t.state,p=l.billingAddress,m=l.coupon,d=l.customAmount,y=l.isCoveringFees,f=l.isOptionallyRecurring,v=l.paymentMethod,g=l.shippingAddress,h=l.taxCalculationId,b=l.taxAmount,O=r.getLineItem("base");return u(t).then((function(u){var l={token:u,payment_method_type:v.id,form_id:o,price_id:O.price.id,price_ids:r.getPriceIds(),quantity:O.quantity,custom_amount:d,tax_amount:b,is_optionally_recurring:f,is_covering_fees:y,coupon_code:!1!==m?m:null,tax_calc_id:h,billing_address:p?{name:p.name,address:p.address}:null,shipping_address:g?{name:g.name,address:g.address}:null,form_values:i()(t,{hash:!0})};return window.wp.apiFetch({url:window.spGeneral.strings.wpJsonUrl+"wpsp/__internal__/payment/create",method:"POST",data:l}).then((function(t){var r=t.client_secret,n=t.customer_id,i=t.object_id,a=t.redirect,o=t.return_url;if(!a)return s({clientSecret:r,objectId:i,customerId:n,returnUrl:o}),c(e);window.location.href=a})).catch((function(e){e.code&&"rest_invalid_param"===e.code&&e.data&&e.data.details&&e.data.details.form_values?n(e.data.details.form_values):n(e),a()}))}))}t.a=function(e){var t=e.paymentForm,r=t.disable,n=t.enable,i=t.error,a=t.setState,d=t.state,y=t.stripejs,f=t.stripeElements,v=t.settings,g=d.clientSecret,h=d.isApplePay,b=d.paymentElement,O="yes"===v.allowMultipleLineItem;if(i(""),g&&null!=b&&b.complete)return r(),c(e);if(b&&!b.complete)return Object(o.d)(t),n();if(!Object(l.c)(t))return Object(l.d)(t),n();if(Object(l.b)(t),!Object(p.c)(t))return Object(p.d)(t),n();Object(p.b)(t);var _=Object(u.c)(t);if(!_)return Object(u.d)(t),n();Object(u.b)(t);var S=Object(s.c)(t,O);if(!S)return O||Object(s.d)(t),n();Object(s.b)(t);var x={isValid:_&&S};if(e.trigger("simpayBeforeStripePayment",[e,x]),!x.isValid)return n();if(r(),h){var j=d.email,P=d.phone,w={elements:f,params:{billing_details:{email:j||null,name:d.name||null,phone:P||null}}};return y.createPaymentMethod(w).then((function(t){var r=t.error,n=t.paymentMethod;if(r)throw r;return a({applePayPaymentMethod:n}),m(e)})).catch((function(e){i(e),n()}))}return m(e)}},,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t),function(e){var t=r(36),n=r(43),i=r(40);function a(e,r){var i=Object(t.a)(e,r);e.addEventListener("submit",(function(e){e.preventDefault(),Object(n.a)(i)}))}window.wpsp={initPaymentForm:a},e((function(){var e=document.querySelectorAll(".simpay-checkout-form");0!==e.length&&(e.forEach((function(e){a(e)})),Object(i.a)())}))}.call(this,r(9))}]);